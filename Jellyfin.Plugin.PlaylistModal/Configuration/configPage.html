<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Playlist Modal Settings</title>
</head>
<body>
    <div id="TemplateConfigPage" data-role="page" class="page type-interior pluginConfigurationPage" data-require="emby-input,emby-button,emby-select,emby-checkbox">
        <div data-role="content">
            <div class="content-primary">
                <form id="TemplateConfigForm">
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="TotalDurationMs">Total Duration (ms)</label>
                        <input id="TotalDurationMs" name="TotalDurationMs" type="number" is="emby-input" min="500" />
                        <div class="fieldDescription">Total spin time</div>
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="MinIntervalMs">Min Interval (ms)</label>
                        <input id="MinIntervalMs" name="MinIntervalMs" type="number" is="emby-input" min="5" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="MaxIntervalMs">Max Interval (ms)</label>
                        <input id="MaxIntervalMs" name="MaxIntervalMs" type="number" is="emby-input" min="50" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="MaxBlur">Max Blur (px)</label>
                        <input id="MaxBlur" name="MaxBlur" type="number" is="emby-input" min="0" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="AnticipationStart">Anticipation Start (0..1)</label>
                        <input id="AnticipationStart" name="AnticipationStart" type="number" step="0.01" is="emby-input" min="0" max="1" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="AnticipationDwellMs">Anticipation Dwell (ms)</label>
                        <input id="AnticipationDwellMs" name="AnticipationDwellMs" type="number" is="emby-input" min="0" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="ConfettiCount">Confetti Count</label>
                        <input id="ConfettiCount" name="ConfettiCount" type="number" is="emby-input" min="0" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="AudioVolume">Audio Volume (0..1)</label>
                        <input id="AudioVolume" name="AudioVolume" type="number" step="0.05" is="emby-input" min="0" max="1" />
                    </div>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="EnableFocusTrap" name="EnableFocusTrap" type="checkbox" is="emby-checkbox" />
                            <span>Enable focus trap</span>
                        </label>
                    </div>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="AutoUpdateCheck" name="AutoUpdateCheck" type="checkbox" is="emby-checkbox" />
                            <span>Enable auto-update checks</span>
                        </label>
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="SurpriseMeText">Surprise Me Button Text</label>
                        <input id="SurpriseMeText" name="SurpriseMeText" type="text" is="emby-input" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="ShowListText">Show List Button Text</label>
                        <input id="ShowListText" name="ShowListText" type="text" is="emby-input" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="PlayItText">Play Button Text</label>
                        <input id="PlayItText" name="PlayItText" type="text" is="emby-input" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="RerollText">Reroll Button Text</label>
                        <input id="RerollText" name="RerollText" type="text" is="emby-input" />
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="CloseText">Close Button Text</label>
                        <input id="CloseText" name="CloseText" type="text" is="emby-input" />
                    </div>
                    <div>
                        <button is="emby-button" type="submit" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
        <script type="text/javascript">
            var TemplateConfig = {
                pluginUniqueId: 'eb5d7894-8eef-4b36-aa6f-5d124e828ce1'
            };

            document.querySelector('#TemplateConfigPage')
                .addEventListener('pageshow', function() {
                    Dashboard.showLoadingMsg();
                    ApiClient.getPluginConfiguration(TemplateConfig.pluginUniqueId).then(function (config) {
                        document.querySelector('#TotalDurationMs').value = config.TotalDurationMs;
                        document.querySelector('#MinIntervalMs').value = config.MinIntervalMs;
                        document.querySelector('#MaxIntervalMs').value = config.MaxIntervalMs;
                        document.querySelector('#MaxBlur').value = config.MaxBlur;
                        document.querySelector('#AnticipationStart').value = config.AnticipationStart;
                        document.querySelector('#AnticipationDwellMs').value = config.AnticipationDwellMs;
                        document.querySelector('#ConfettiCount').value = config.ConfettiCount;
                        document.querySelector('#AudioVolume').value = config.AudioVolume;
                        document.querySelector('#EnableFocusTrap').checked = config.EnableFocusTrap;
                        document.querySelector('#AutoUpdateCheck').checked = config.AutoUpdateCheck;
                        document.querySelector('#SurpriseMeText').value = config.SurpriseMeText;
                        document.querySelector('#ShowListText').value = config.ShowListText;
                        document.querySelector('#PlayItText').value = config.PlayItText;
                        document.querySelector('#RerollText').value = config.RerollText;
                        document.querySelector('#CloseText').value = config.CloseText;
                        Dashboard.hideLoadingMsg();
                    });
                });

            document.querySelector('#TemplateConfigForm')
                .addEventListener('submit', function(e) {
                Dashboard.showLoadingMsg();
                ApiClient.getPluginConfiguration(TemplateConfig.pluginUniqueId).then(function (config) {
                    config.TotalDurationMs = parseInt(document.querySelector('#TotalDurationMs').value || '0', 10);
                    config.MinIntervalMs = parseInt(document.querySelector('#MinIntervalMs').value || '0', 10);
                    config.MaxIntervalMs = parseInt(document.querySelector('#MaxIntervalMs').value || '0', 10);
                    config.MaxBlur = parseInt(document.querySelector('#MaxBlur').value || '0', 10);
                    config.AnticipationStart = parseFloat(document.querySelector('#AnticipationStart').value || '0');
                    config.AnticipationDwellMs = parseInt(document.querySelector('#AnticipationDwellMs').value || '0', 10);
                    config.ConfettiCount = parseInt(document.querySelector('#ConfettiCount').value || '0', 10);
                    config.AudioVolume = parseFloat(document.querySelector('#AudioVolume').value || '0');
                    config.EnableFocusTrap = document.querySelector('#EnableFocusTrap').checked;
                    config.AutoUpdateCheck = document.querySelector('#AutoUpdateCheck').checked;
                    config.SurpriseMeText = document.querySelector('#SurpriseMeText').value || 'üçø Surprise Me!';
                    config.ShowListText = document.querySelector('#ShowListText').value || 'üéûÔ∏è Show List';
                    config.PlayItText = document.querySelector('#PlayItText').value || 'üé¨ Play it!';
                    config.RerollText = document.querySelector('#RerollText').value || 'üé≤ Reroll';
                    config.CloseText = document.querySelector('#CloseText').value || 'Close';
                    ApiClient.updatePluginConfiguration(TemplateConfig.pluginUniqueId, config).then(function (result) {
                        Dashboard.processPluginConfigurationUpdateResult(result);
                    });
                });

                e.preventDefault();
                return false;
            });
        </script>
    </div>
</body>
</html>
